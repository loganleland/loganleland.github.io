<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="../style.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>leland.zip</title>
</head>
  <body>
    <nav>
      <div class="nav-container">
        <a href="../index.html" class="logo">leland.zip</a>
        <ul class="nav-links">
          <li><a href="../blog.html">Blog</a></li>
          <li><a href="../contact.html">Contact</a></li>
        </ul>
      </div>
    </nav>

<!-- Table of Contents -->
    <section class="toc-container">
        <div class="toc-wrapper">
            <h2 class="toc-title">Table of Contents</h2>
            <ol class="toc-list">
                <li class="toc-item">
                    <a href="#setup" class="toc-link">Setup</a>
                    <ul class="toc-nested">
                        <li class="toc-item"><a href="#select" class="toc-link">Purchase</a></li>
                        <li class="toc-item"><a href="#bootloader" class="toc-link">Unlock Bootloader</a></li>
                        <li class="toc-item"><a href="#root" class="toc-link">Root</a></li>
                        <li class="toc-item"><a href="#final-setup" class="toc-link">Finish Setup QoL</a></li>
                     </ul>
                </li>
                
                <li class="toc-item">
                    <a href="#drivers" class="toc-link">Userspace Drivers</a>
                    <ul class="toc-nested">
                        <li class="toc-item">
                            <a href="#device-files" class="toc-link">Device Files</a>
                        </li>
                    </ul>
                </li>
            </ol>
        </div>
    </section>

    <article class="article-container">
      <div class="article-content">
        <h1 id="setup">Setup</h1> <p></p>
        <h2 id="purchase">Purchase</h2> 
          <p> The following is written with a pixel 9 bought from the google store without financing. Do not unlock the bootloader or root your personal use cellphone. Unlocking the bootloader will erase data on the pixel 9 and if done incorrectly and brick the device.</p>
          <ul>
            <li> Buying from sources other than Google can hinder unlocking of the bootloader.</li>
            <li> It has been reported Verizon disallows unlocking the bootloader of financed pixel 9 and when paid off will require you take additional actions for unlocking the bootloader.
            <li>Note that carrier locking is different than bootloader locking</li>
          </ul>

          <p>If you don't already have a cable to connect the pixel to a laptop I would suggest the 4-1 100W cable from xcool since it can connect to all common kinds of USB ports.</p>
          <p>Depending on your use case the mission darkness faraday bag with window and usb passthrough works well. With max screen brightness you'll be able to observe the pixel 9 screen:</p>

          <img src="../images/faraday.png">

          <p>The pixel 9 has a variety of RF attack surface and can be interesting to reverse engineer. While there's cheaper ways to go about this one option is to use a B205 mini from Ettus Research.</p>
        <ul>
          <li> https://store.google.com/product/pixel_9 </li>
          <li> https://mosequipment.com/products/mission-darkness-window-charge-shield-faraday-bag </li>
          <li> https://www.coolgadget.com/products/xcool-cable-monster-usb-c-charger-cable </li>
          <li> https://www.ettus.com/all-products/usrp-b205mini-i/ </li>          
        </ul>


         <h2 id="bootloader">Unlock Bootloader</h2> 
          <p> Unlocking the bootloader can provide the following:</p>
          <ul>
            <li>Obtain root with Magisk</li>
            <li>Downgrade to older software to develop against known vulns</li>
            <li>Rewrite kernel / vendor code for various purposes</li>
            <li>Recover from future bootloops</li>
          </ul>

          <p> <font color="#54ffb2">1.</font> Enable developer mode: </p>
          <ul>
            <li>Settings -> About Phone</li>
            <li>Click on Build Number until developer mode is enabled</li>
          </ul>        

        <p> <font color="#54ffb2">2.</font> Enable OEM unlocking </p>
        <ul>
          <li>Settings -> Developer Options</li>
          <li>Click: OEM unlocking</li>
          <li>Enable: Allow OEM unlocking </li>
        </ul>

        <p> <font color="#54ffb2">3.</font> Install fastboot on a laptop/desktop: https://developer.android.com/tools/releases/platform-tools#downloads</p>

        <p> <font color="#54ffb2">4.</font> Reboot device into fast boot mode </p>
        <ul>
          <li>Restart device</li>
          <li>Hold volume down during restart process</li>
          <li>Fastboot menu should now be visible</li>
        </ul>

        <p> <font color="#54ffb2">5.</font> Fastboot unlock </p>
        <div class="callout">
          <p>This step will erase data</p>
        </div>
        <ul>
          <li> Connect device via usb to laptop </li>
          <li> On laptop execute: fastboot devices; ensure serial number is in stdout</li>
          <li> On laptop execute: fastboot flashing unlock</li>
          <li> Pixel 9 screen should display a warning regarding unlocking the bootloader </li>
          <li> Use volume buttons to change: "Do not unlock the bootloader" to "Unlock the bootloader"</li>
          <li> Press power button to trigger a reboot</li>
          <li> Debug menu should show: Device state: unlocked</li>
          <li> Press power button with option: Start</li>
        </ul>

        <p> Each restart will display a warning regarding the bootloader being unlocked. Fastboot can be used to lock the bootloader.</p>
	<ul>
          <li> https://android.googlesource.com/platform/system/core/+/master/fastboot </li>
	</ul>
 
        <h2 id="root">Root</h2> 
        <p>Root is not strictly required but can make your life easier when working with a pixel. You'll be able to interact with userspace device drivers, ssh with a laptop over usb and install packages in termux without root.</p>
        <p>With the bootloader unlocked Magisk can be used to provide root.<p>
        <p> <font color="#54ffb2">1.</font> Record the build number to download correct factory image.</p>
        <ul>
          <li> Settings -> About Phone</li>
          <li> Scroll to bottom </li>
          <li> At the time of writing my pixel 9's build number is: <b>BP1A.250505.005</b> </li>
        </ul>
        <div class="callout">
          <p>Recording an incorrect build number can brick your device</p>
        </div>

        <p> <font color="#54ffb2">2.</font> Obtain a factory image from https://developers.google.com/android/images for your device/build number.</p>
        <p> Links to each factory image for each variant of the pixel devices: </p>
        <ul>
          <li><a href="https://developers.google.com/android/images#tokay">tokay aka Pixel 9</a></li>
          <li><a href="https://developers.google.com/android/images#komodo">komodo aka Pixel 9 Pro XL</a></li>
          <li><a href="https://developers.google.com/android/images#caiman">caiman aka Pixel 9 Pro</a></li>
          <li><a href="https://developers.google.com/android/images#comet">comet aka Pixel 9 Pro Fold</a></li>
          <li> <a href="https://developers.google.com/android/images#tegu">tegu for Pixel 9a</a></li>
        </ul>

        <p> Take note of image variants for Verizon, DTAG, TW, EMEA, T-Mobile and Telestra. You don't want to mix and match variants (don't flash a Verizon variant if you didn't buy the pixel 9 from verizon).</p>

        <p> <font color="#54ffb2">3.</font> After downloading the image check the sha256 hash matches.</p>
        <div class="callout">
          <p>If the hash doesn't match you will likely brick your device</p>
        </div>
        <p> <font color="#54ffb2">4.</font> Extract init_boot.img from factory image on laptop</p>
        <ul>
          <li>unzip tokay-bp1a.250505.005-factory-5e869188.zip</li>
          <li>unzip image-tokay-bp1a.250505.005.zip</li>
          <li>Observe init_boot.img</li>
        </ul>

        <p> <font color="#54ffb2">5.</font> Download Magisk </p>
	<ul><li>Download the latest apk from https://github.com/topjohnwu/Magisk/releases</li></ul>
        <p> <font color="#54ffb2">6.</font> Connect and Enable USB File Transfer.</p>
	<ul><li> Move init_boot.img to Download folder of pixel's internal storage</li>
	    <li> Move Magisk apk to Download folder of pixel's internal storage</li>
	</ul>

        <p> <font color="#54ffb2">7.</font> Install Magisk apk </p>
	<ul>
          <li> Enable: Install unknown apps </li>
          <li> Click Magisk apk in Downloads folder to install </li>
        </ul>
        <p> <font color="#54ffb2">8.</font> Patch init_boot.img from Magisk </p>
        <ul>
        <li> Execute Magisk: Install </li>
        <li> Select and Patch a File</li>
        <li> Select: init_boot.img (if init_boot.img is incorrect device will be bricked after flashing)</li>
        <li> Select: LET'S GO</li>
        <li> A newly created <b>magisk_patched-29000_oMslj.img</b> should be created next to init_boot.img on the pixel</li>
        <li> Transfer <b>magisk_patched-29000_oMslj.img</b> to your laptop</li>
        </ul>

        <p> <font color="#54ffb2">9.</font> Enable Developer Mode / USB Debugging</p>
	<ul>
        <li> Enable developer mode again since it could be wiped after unlocking the bootloader</li>
        <li> Enable USB Debugging for adb </li>
        <li> Trust laptop for usb debugging </li>
        </ul>

        <p> <font color="#54ffb2">10.</font> Reboot into bootloader </p>
        <ul>
          <li> Execute on laptop: adb devices</li>
          <li> A single device (your pixel phone) should be listed from previous command </li>
          <li> Execute on laptop: adb reboot bootloader</li>
          <li> Pixel should restart into fastboot mode</li>
        </ul>

        <p> <font color="#54ffb2">11.</font> Flash patched init_boot.img </p>
	<ul><li> Execute on laptop: fastboot flash init_boot /path/to/patched_init_boot.img</li></ul>
        <pre data-language="bash"><code>leland@light:~/Downloads/$ fastboot flash init_boot ./magisk_patched-29000_oMsIj.img 
Sending 'init_boot_a' (8192 KB)                    OKAY [  0.364s]
Writing 'init_boot_a'                              OKAY [  0.074s]
Finished. Total time: 0.442s
        </code></pre>
          
	<ul><li> Execute on laptop: fastboot reboot</li></ul>

        <b> Pixel is now rooted </b>

        <h2 id="final-setup">Finsh Setup QoL</h2> 
        <p> <font color="#54ffb2">1.</font> Install Termux. Download the latest non-beta release for arm64 from</p>
        <ul>
          <li>https://github.com/termux/termux-app/releases</li>
        </ul>
        <p> <font color="#54ffb2">2.</font> Execute in Termux: su </p>
        <p> <font color="#54ffb2">2.</font> Grant Termux Root </p>
        <ul>
          <li>Execute in termux: su</li>
          <li>Magisk prompt will appear: grant termux superuser priv </li>
        </ul>

        <p> <font color="#54ffb2">4.</font> Execute in Termux: pkg install openssh clang vim</p>
        <p> <font color="#54ffb2">5.</font> Execute in Termux (pick password): passwd</p>

        <p> <font color="#54ffb2">6.</font> SSH over usb with adb and termux</p>
        <ul>
          <li>Execute in Termux: sshd</li>
          <li>Execute on laptop: adb forward tcp:8022 tcp:8022</li>
          <li>Execute on laptop: ssh -p 8022 localhost</li>
        </ul>

        <h1 id="drivers">Drivers</h1> <p></p>
        <h2 id="device-files">Device Files</h2>
        <h3>Background</h3>
        <p> On android and unix in general a special file called a character device driver exists to control physical hardware (gpu, camera, microphones, battery, gps, usb, etc).
            These files expose an interface for userland to interact with physical hardware/kernel module. This is done by the OS redirecting calls such as open, ioctl, read, write specified by the structure file_operations.
          <pre data-language="c"><code>static const struct file_operations kbase_fops = {
	.owner = THIS_MODULE,
	.open = kbase_open,
	.release = kbase_release,
	.read = kbase_read,
	.poll = kbase_poll,
	.unlocked_ioctl = kbase_ioctl,
	.compat_ioctl = kbase_ioctl,
	.mmap = kbase_mmap,
	.check_flags = kbase_check_flags,
	.get_unmapped_area = kbase_get_unmapped_area,
};</code></pre>

        In the above example userland calls to open of the character device is redirected to kbase_open and ioctl calls to the opened device is defined by kbase_ioctl and so on. 
        </p>

        <p> To list character devices in DevFS (root required):</p>
        <pre data-language="bash"><code># find / -type c 2>/dev/null | sort</code></pre>

        <details>
          <summary>Character device list in DevFS</summary>
          <ul>
            <li>/dev/0:0:0:0</li>
            <li>/dev/0:0:0:1</li>
            <li>/dev/0:0:0:2</li>
            <li>/dev/0:0:0:3</li>
            <li>/dev/0:0:0:49456</li>
            <li>/dev/0:0:0:49476</li>
            <li>/dev/0:0:0:49488</li>
            <li>/dev/acd-ambient_pcm</li>
            <li>/dev/acd-aocx_control</li>
            <li>/dev/acd-aocx_inject0</li>
            <li>/dev/acd-aocx_inject1</li>
            <li>/dev/acd-aocx_tapout0</li>
            <li>/dev/acd-aocx_tapout1</li>
            <li>/dev/acd-audio_ap_offload_rx</li>
            <li>/dev/acd-audio_ap_offload_tx</li>
            <li>/dev/acd-audio_bulk_rx</li>
            <li>/dev/acd-audio_bulk_tx</li>
            <li>/dev/acd-audio_dcdoff_ref</li>
            <li>/dev/acd-audio_haptaudio</li>
            <li>/dev/acd-audio_input_bulk_rx</li>
            <li>/dev/acd-audio_input_bulk_tx</li>
            <li>/dev/acd-audio_input_tuning</li>
            <li>/dev/acd-audio_output_tuning</li>
            <li>/dev/acd-audio_output_tuning_ext</li>
            <li>/dev/acd-audio_rtp_rx</li>
            <li>/dev/acd-audio_rtp_tx</li>
            <li>/dev/acd-audio_spatial_f1</li>
            <li>/dev/acd-audio_tap0</li>
            <li>/dev/acd-audio_tap1</li>
            <li>/dev/acd-audio_tap10</li>
            <li>/dev/acd-audio_tap11</li>
            <li>/dev/acd-audio_tap2</li>
            <li>/dev/acd-audio_tap3</li>
            <li>/dev/acd-audio_tap4</li>
            <li>/dev/acd-audio_tap5</li>
            <li>/dev/acd-audio_tap6</li>
            <li>/dev/acd-audio_tap7</li>
            <li>/dev/acd-audio_tap8</li>
            <li>/dev/acd-audio_tap9</li>
            <li>/dev/acd-chre_bt_offload_ctl</li>
            <li>/dev/acd-chre_bt_offload_data_rx</li>
            <li>/dev/acd-chre_bt_offload_data_tx</li>
            <li>/dev/acd-chre_ctl</li>
            <li>/dev/acd-chre_data_rx</li>
            <li>/dev/acd-chre_data_tx</li>
            <li>/dev/acd-com.google.chre</li>
            <li>/dev/acd-com.google.chre.non_wake_up</li>
            <li>/dev/acd-com.google.umfw_stat</li>
            <li>/dev/acd-com.google.usf</li>
            <li>/dev/acd-com.google.usf.non_wake_up</li>
            <li>/dev/acd-debug</li>
            <li>/dev/acd-factory_diag</li>
            <li>/dev/acd-hotword_notification</li>
            <li>/dev/acd-hotword_pcm</li>
            <li>/dev/acd-logging</li>
            <li>/dev/acd-mc_headpos</li>
            <li>/dev/acd-mel_processor</li>
            <li>/dev/acd-model_data</li>
            <li>/dev/acd-sound_trigger</li>
            <li>/dev/acd-trace_3z_0</li>
            <li>/dev/acd-trace_3z_1</li>
            <li>/dev/acd-trace_a32</li>
            <li>/dev/acd-trace_f1</li>
            <li>/dev/amcs</li>
            <li>/dev/aoc</li>
            <li>/dev/ashmem</li>
            <li>/dev/ashmema89909c8-c70e-430d-8521-dfc7ad14edb7</li>
            <li>/dev/battery_history</li>
            <li>/dev/bigwave</li>
            <li>/dev/binderfs/binder</li>
            <li>/dev/binderfs/binder-control</li>
            <li>/dev/binderfs/hwbinder</li>
            <li>/dev/binderfs/vndbinder</li>
            <li>/dev/cluster0_freq_max</li>
            <li>/dev/cluster0_freq_min</li>
            <li>/dev/cluster1_freq_max</li>
            <li>/dev/cluster1_freq_min</li>
            <li>/dev/cluster2_freq_max</li>
            <li>/dev/cluster2_freq_min</li>
            <li>/dev/console</li>
            <li>/dev/cpu_dma_latency</li>
            <li>/dev/device-mapper</li>
            <li>/dev/dma_heap/aaudio_capture_heap</li>
            <li>/dev/dma_heap/aaudio_playback_heap</li>
            <li>/dev/dma_heap/faceauth_dsp-secure</li>
            <li>/dev/dma_heap/faceauth_tpu-secure</li>
            <li>/dev/dma_heap/famodel-secure</li>
            <li>/dev/dma_heap/faprev-secure</li>
            <li>/dev/dma_heap/farawimg-secure</li>
            <li>/dev/dma_heap/mfc_fw-secure</li>
            <li>/dev/dma_heap/sensor_direct_heap</li>
            <li>/dev/dma_heap/system</li>
            <li>/dev/dma_heap/system-uncached</li>
            <li>/dev/dma_heap/tui-secure</li>
            <li>/dev/dma_heap/vframe-secure</li>
            <li>/dev/dma_heap/video_system</li>
            <li>/dev/dma_heap/video_system-uncached</li>
            <li>/dev/dma_heap/vscaler-secure</li>
            <li>/dev/dma_heap/vstream-secure</li>
            <li>/dev/dri/card0</li>
            <li>/dev/dri/renderD128</li>
            <li>/dev/edgetpu-soc</li>
            <li>/dev/fimg2d</li>
            <li>/dev/full</li>
            <li>/dev/fuse</li>
            <li>/dev/g2d</li>
            <li>/dev/gnss_boot</li>
            <li>/dev/gnss_dump</li>
            <li>/dev/gnss_ipc</li>
            <li>/dev/gpiochip0</li>
            <li>/dev/gpiochip1</li>
            <li>/dev/gpiochip10</li>
            <li>/dev/gpiochip11</li>
            <li>/dev/gpiochip12</li>
            <li>/dev/gpiochip13</li>
            <li>/dev/gpiochip14</li>
            <li>/dev/gpiochip15</li>
            <li>/dev/gpiochip16</li>
            <li>/dev/gpiochip17</li>
            <li>/dev/gpiochip18</li>
            <li>/dev/gpiochip19</li>
            <li>/dev/gpiochip2</li>
            <li>/dev/gpiochip20</li>
            <li>/dev/gpiochip21</li>
            <li>/dev/gpiochip22</li>
            <li>/dev/gpiochip23</li>
            <li>/dev/gpiochip24</li>
            <li>/dev/gpiochip25</li>
            <li>/dev/gpiochip26</li>
            <li>/dev/gpiochip27</li>
            <li>/dev/gpiochip28</li>
            <li>/dev/gpiochip29</li>
            <li>/dev/gpiochip3</li>
            <li>/dev/gpiochip30</li>
            <li>/dev/gpiochip31</li>
            <li>/dev/gpiochip32</li>
            <li>/dev/gpiochip33</li>
            <li>/dev/gpiochip34</li>
            <li>/dev/gpiochip35</li>
            <li>/dev/gpiochip36</li>
            <li>/dev/gpiochip37</li>
            <li>/dev/gpiochip38</li>
            <li>/dev/gpiochip39</li>
            <li>/dev/gpiochip4</li>
            <li>/dev/gpiochip40</li>
            <li>/dev/gpiochip41</li>
            <li>/dev/gpiochip42</li>
            <li>/dev/gpiochip43</li>
            <li>/dev/gpiochip44</li>
            <li>/dev/gpiochip45</li>
            <li>/dev/gpiochip46</li>
            <li>/dev/gpiochip47</li>
            <li>/dev/gpiochip48</li>
            <li>/dev/gpiochip49</li>
            <li>/dev/gpiochip5</li>
            <li>/dev/gpiochip50</li>
            <li>/dev/gpiochip51</li>
            <li>/dev/gpiochip52</li>
            <li>/dev/gpiochip53</li>
            <li>/dev/gpiochip54</li>
            <li>/dev/gpiochip55</li>
            <li>/dev/gpiochip56</li>
            <li>/dev/gpiochip57</li>
            <li>/dev/gpiochip58</li>
            <li>/dev/gpiochip59</li>
            <li>/dev/gpiochip6</li>
            <li>/dev/gpiochip60</li>
            <li>/dev/gpiochip61</li>
            <li>/dev/gpiochip62</li>
            <li>/dev/gpiochip63</li>
            <li>/dev/gpiochip64</li>
            <li>/dev/gpiochip7</li>
            <li>/dev/gpiochip8</li>
            <li>/dev/gpiochip9</li>
            <li>/dev/gsa0</li>
            <li>/dev/gsc0</li>
            <li>/dev/gti.0</li>
            <li>/dev/gxp</li>
            <li>/dev/hdcp2</li>
            <li>/dev/hw_random</li>
            <li>/dev/i2c-10</li>
            <li>/dev/i2c-19</li>
            <li>/dev/i2c-2</li>
            <li>/dev/i2c-3</li>
            <li>/dev/i2c-4</li>
            <li>/dev/i2c-5</li>
            <li>/dev/i2c-6</li>
            <li>/dev/i2c-7</li>
            <li>/dev/i2c-8</li>
            <li>/dev/i2c-9</li>
            <li>/dev/input/event0</li>
            <li>/dev/input/event1</li>
            <li>/dev/input/event2</li>
            <li>/dev/input/event3</li>
            <li>/dev/ispolin_ranging</li>
            <li>/dev/kmsg</li>
            <li>/dev/kvm</li>
            <li>/dev/logbuffer_bd</li>
            <li>/dev/logbuffer_btlpm</li>
            <li>/dev/logbuffer_cpif</li>
            <li>/dev/logbuffer_cpm</li>
            <li>/dev/logbuffer_dsim0</li>
            <li>/dev/logbuffer_max77779_fwupdate</li>
            <li>/dev/logbuffer_max77779fg</li>
            <li>/dev/logbuffer_max77779fg_monitor</li>
            <li>/dev/logbuffer_pca9468</li>
            <li>/dev/logbuffer_pcie0</li>
            <li>/dev/logbuffer_pcie1</li>
            <li>/dev/logbuffer_rtx</li>
            <li>/dev/logbuffer_ssoc</li>
            <li>/dev/logbuffer_tcpm</li>
            <li>/dev/logbuffer_ttf</li>
            <li>/dev/logbuffer_tty18</li>
            <li>/dev/logbuffer_usbpd</li>
            <li>/dev/logbuffer_wireless</li>
            <li>/dev/loop-control</li>
            <li>/dev/lwis-act-cornerfolk</li>
            <li>/dev/lwis-act-cornerfolk-dokkaebi</li>
            <li>/dev/lwis-act-cornerfolk-taotie-uw</li>
            <li>/dev/lwis-be-core</li>
            <li>/dev/lwis-dpm</li>
            <li>/dev/lwis-eeprom-djinn</li>
            <li>/dev/lwis-eeprom-smaug-dokkaebi</li>
            <li>/dev/lwis-eeprom-smaug-taotie-uw</li>
            <li>/dev/lwis-flash-lm3644</li>
            <li>/dev/lwis-gdc0</li>
            <li>/dev/lwis-gdc1</li>
            <li>/dev/lwis-gse</li>
            <li>/dev/lwis-gtnr-align</li>
            <li>/dev/lwis-gtnr-merge</li>
            <li>/dev/lwis-isp-fe</li>
            <li>/dev/lwis-lme</li>
            <li>/dev/lwis-mcsc</li>
            <li>/dev/lwis-ois-djinn</li>
            <li>/dev/lwis-sensor-boitata</li>
            <li>/dev/lwis-sensor-dokkaebi</li>
            <li>/dev/lwis-sensor-taotie-uw</li>
            <li>/dev/lwis-slc</li>
            <li>/dev/lwis-test</li>
            <li>/dev/lwis-top</li>
            <li>/dev/lwis-votf</li>
            <li>/dev/mali0</li>
            <li>/dev/multipdp</li>
            <li>/dev/null</li>
            <li>/dev/oem_ipc0</li>
            <li>/dev/oem_ipc1</li>
            <li>/dev/oem_ipc2</li>
            <li>/dev/oem_ipc3</li>
            <li>/dev/oem_ipc4</li>
            <li>/dev/oem_ipc5</li>
            <li>/dev/oem_ipc6</li>
            <li>/dev/oem_ipc7</li>
            <li>/dev/oem_test</li>
            <li>/dev/pmsg0</li>
            <li>/dev/ppp</li>
            <li>/dev/ptmx</li>
            <li>/dev/pts/0</li>
            <li>/dev/pts/1</li>
            <li>/dev/pts/ptmx</li>
            <li>/dev/qbt_fd</li>
            <li>/dev/qbt_ipc</li>
            <li>/dev/random</li>
            <li>/dev/rfkill</li>
            <li>/dev/rio</li>
            <li>/dev/rtc0</li>
            <li>/dev/sg0</li>
            <li>/dev/sg1</li>
            <li>/dev/sg2</li>
            <li>/dev/sg3</li>
            <li>/dev/sg4</li>
            <li>/dev/sg5</li>
            <li>/dev/sg6</li>
            <li>/dev/snapshot</li>
            <li>/dev/snd/comprC0D6</li>
            <li>/dev/snd/controlC0</li>
            <li>/dev/snd/pcmC0D0p</li>
            <li>/dev/snd/pcmC0D10c</li>
            <li>/dev/snd/pcmC0D11c</li>
            <li>/dev/snd/pcmC0D12c</li>
            <li>/dev/snd/pcmC0D13c</li>
            <li>/dev/snd/pcmC0D14p</li>
            <li>/dev/snd/pcmC0D15c</li>
            <li>/dev/snd/pcmC0D16p</li>
            <li>/dev/snd/pcmC0D17c</li>
            <li>/dev/snd/pcmC0D18p</li>
            <li>/dev/snd/pcmC0D19p</li>
            <li>/dev/snd/pcmC0D1p</li>
            <li>/dev/snd/pcmC0D20c</li>
            <li>/dev/snd/pcmC0D21c</li>
            <li>/dev/snd/pcmC0D22c</li>
            <li>/dev/snd/pcmC0D23p</li>
            <li>/dev/snd/pcmC0D24p</li>
            <li>/dev/snd/pcmC0D25p</li>
            <li>/dev/snd/pcmC0D26c</li>
            <li>/dev/snd/pcmC0D27c</li>
            <li>/dev/snd/pcmC0D28p</li>
            <li>/dev/snd/pcmC0D29p</li>
            <li>/dev/snd/pcmC0D2p</li>
            <li>/dev/snd/pcmC0D30p</li>
            <li>/dev/snd/pcmC0D31p</li>
            <li>/dev/snd/pcmC0D32c</li>
            <li>/dev/snd/pcmC0D3p</li>
            <li>/dev/snd/pcmC0D4p</li>
            <li>/dev/snd/pcmC0D53p</li>
            <li>/dev/snd/pcmC0D54c</li>
            <li>/dev/snd/pcmC0D5p</li>
            <li>/dev/snd/pcmC0D7p</li>
            <li>/dev/snd/pcmC0D8c</li>
            <li>/dev/snd/pcmC0D9c</li>
            <li>/dev/snd/timer</li>
            <li>/dev/sscd_aoc</li>
            <li>/dev/sscd_bigwave</li>
            <li>/dev/sscd_debugcore</li>
            <li>/dev/sscd_gnss</li>
            <li>/dev/sscd_gxp_callisto</li>
            <li>/dev/sscd_mali</li>
            <li>/dev/sscd_mfc-core</li>
            <li>/dev/sscd_rio</li>
            <li>/dev/sscd_wlan</li>
            <li>/dev/st21nfc</li>
            <li>/dev/st54spi</li>
            <li>/dev/tcm0</li>
            <li>/dev/touch_offload</li>
            <li>/dev/trusty-ipc-dev0</li>
            <li>/dev/trusty-log0</li>
            <li>/dev/tty</li>
            <li>/dev/ttyGS0</li>
            <li>/dev/ttyGS1</li>
            <li>/dev/ttyGS2</li>
            <li>/dev/ttySAC0</li>
            <li>/dev/ttySAC18</li>
            <li>/dev/ttynull</li>
            <li>/dev/tui-driver</li>
            <li>/dev/tun</li>
            <li>/dev/ublk-control</li>
            <li>/dev/ufs-bsg0</li>
            <li>/dev/uhid</li>
            <li>/dev/uinput</li>
            <li>/dev/umts_boot0</li>
            <li>/dev/umts_dm0</li>
            <li>/dev/umts_ipc0</li>
            <li>/dev/umts_ipc1</li>
            <li>/dev/umts_loopback</li>
            <li>/dev/umts_rcs0</li>
            <li>/dev/umts_rcs1</li>
            <li>/dev/umts_rfs0</li>
            <li>/dev/umts_router</li>
            <li>/dev/umts_toe0</li>
            <li>/dev/umts_wfc0</li>
            <li>/dev/umts_wfc1</li>
            <li>/dev/urandom</li>
            <li>/dev/usb_accessory</li>
            <li>/dev/userfaultfd</li>
            <li>/dev/v4l-touch0</li>
            <li>/dev/vhost-vsock</li>
            <li>/dev/video10</li>
            <li>/dev/video11</li>
            <li>/dev/video12</li>
            <li>/dev/video6</li>
            <li>/dev/video7</li>
            <li>/dev/video8</li>
            <li>/dev/video9</li>
            <li>/dev/vsock</li>
            <li>/dev/watchdog</li>
            <li>/dev/watchdog0</li>
            <li>/dev/watchdog1</li>
            <li>/dev/wbrc</li>
            <li>/dev/zero</li>
            <li>/sys/fs/selinux/null</li>
          </ul>
        </details>

        <p>There are 369 results in DevFS. To help narrow focus find which are directly and indirectly assessible from an unprivileged context.</p>
        <p>To find directly assessible character devices try to open each device then write to stdout if successful.</p>
        <pre><code data-language="c">
#include "stdio.h"

int main() {
  char* devices[] = {"/dev/0:0:0:0", "/dev/0:0:0:1", "/dev/0:0:0:2", "/dev/0:0:0:3", "/dev/0:0:0:49456", "/dev/0:0:0:49476", "/dev/0:0:0:49488", "/dev/acd-ambient_pcm", "/dev/acd-aocx_control", "/dev/acd-aocx_inject0", "/dev/acd-aocx_inject1", "/dev/acd-aocx_tapout0", "/dev/acd-aocx_tapout1", "/dev/acd-audio_ap_offload_rx", "/dev/acd-audio_ap_offload_tx", "/dev/acd-audio_bulk_rx", "/dev/acd-audio_bulk_tx", "/dev/acd-audio_dcdoff_ref", "/dev/acd-audio_haptaudio", "/dev/acd-audio_input_bulk_rx", "/dev/acd-audio_input_bulk_tx", "/dev/acd-audio_input_tuning", "/dev/acd-audio_output_tuning", "/dev/acd-audio_output_tuning_ext", "/dev/acd-audio_rtp_rx", "/dev/acd-audio_rtp_tx", "/dev/acd-audio_spatial_f1", "/dev/acd-audio_tap0", "/dev/acd-audio_tap1", "/dev/acd-audio_tap10", "/dev/acd-audio_tap11", "/dev/acd-audio_tap2", "/dev/acd-audio_tap3", "/dev/acd-audio_tap4", "/dev/acd-audio_tap5", "/dev/acd-audio_tap6", "/dev/acd-audio_tap7", "/dev/acd-audio_tap8", "/dev/acd-audio_tap9", "/dev/acd-chre_bt_offload_ctl", "/dev/acd-chre_bt_offload_data_rx", "/dev/acd-chre_bt_offload_data_tx", "/dev/acd-chre_ctl", "/dev/acd-chre_data_rx", "/dev/acd-chre_data_tx", "/dev/acd-com.google.chre", "/dev/acd-com.google.chre.non_wake_up", "/dev/acd-com.google.umfw_stat", "/dev/acd-com.google.usf", "/dev/acd-com.google.usf.non_wake_up", "/dev/acd-debug", "/dev/acd-factory_diag", "/dev/acd-hotword_notification", "/dev/acd-hotword_pcm", "/dev/acd-logging", "/dev/acd-mc_headpos", "/dev/acd-mel_processor", "/dev/acd-model_data", "/dev/acd-sound_trigger", "/dev/acd-trace_3z_0", "/dev/acd-trace_3z_1", "/dev/acd-trace_a32", "/dev/acd-trace_f1", "/dev/amcs", "/dev/aoc", "/dev/ashmem", "/dev/ashmema89909c8-c70e-430d-8521-dfc7ad14edb7", "/dev/battery_history", "/dev/bigwave", "/dev/binderfs/binder", "/dev/binderfs/binder-control", "/dev/binderfs/hwbinder", "/dev/binderfs/vndbinder", "/dev/cluster0_freq_max", "/dev/cluster0_freq_min", "/dev/cluster1_freq_max", "/dev/cluster1_freq_min", "/dev/cluster2_freq_max", "/dev/cluster2_freq_min", "/dev/console", "/dev/cpu_dma_latency", "/dev/device-mapper", "/dev/dma_heap/aaudio_capture_heap", "/dev/dma_heap/aaudio_playback_heap", "/dev/dma_heap/faceauth_dsp-secure", "/dev/dma_heap/faceauth_tpu-secure", "/dev/dma_heap/famodel-secure", "/dev/dma_heap/faprev-secure", "/dev/dma_heap/farawimg-secure", "/dev/dma_heap/mfc_fw-secure", "/dev/dma_heap/sensor_direct_heap", "/dev/dma_heap/system", "/dev/dma_heap/system-uncached", "/dev/dma_heap/tui-secure", "/dev/dma_heap/vframe-secure", "/dev/dma_heap/video_system", "/dev/dma_heap/video_system-uncached", "/dev/dma_heap/vscaler-secure", "/dev/dma_heap/vstream-secure", "/dev/dri/card0", "/dev/dri/renderD128", "/dev/edgetpu-soc", "/dev/fimg2d", "/dev/full", "/dev/fuse", "/dev/g2d", "/dev/gnss_boot", "/dev/gnss_dump", "/dev/gnss_ipc", "/dev/gpiochip0", "/dev/gpiochip1", "/dev/gpiochip10", "/dev/gpiochip11", "/dev/gpiochip12", "/dev/gpiochip13", "/dev/gpiochip14", "/dev/gpiochip15", "/dev/gpiochip16", "/dev/gpiochip17", "/dev/gpiochip18", "/dev/gpiochip19", "/dev/gpiochip2", "/dev/gpiochip20", "/dev/gpiochip21", "/dev/gpiochip22", "/dev/gpiochip23", "/dev/gpiochip24", "/dev/gpiochip25", "/dev/gpiochip26", "/dev/gpiochip27", "/dev/gpiochip28", "/dev/gpiochip29", "/dev/gpiochip3", "/dev/gpiochip30", "/dev/gpiochip31", "/dev/gpiochip32", "/dev/gpiochip33", "/dev/gpiochip34", "/dev/gpiochip35", "/dev/gpiochip36", "/dev/gpiochip37", "/dev/gpiochip38", "/dev/gpiochip39", "/dev/gpiochip4", "/dev/gpiochip40", "/dev/gpiochip41", "/dev/gpiochip42", "/dev/gpiochip43", "/dev/gpiochip44", "/dev/gpiochip45", "/dev/gpiochip46", "/dev/gpiochip47", "/dev/gpiochip48", "/dev/gpiochip49", "/dev/gpiochip5", "/dev/gpiochip50", "/dev/gpiochip51", "/dev/gpiochip52", "/dev/gpiochip53", "/dev/gpiochip54", "/dev/gpiochip55", "/dev/gpiochip56", "/dev/gpiochip57", "/dev/gpiochip58", "/dev/gpiochip59", "/dev/gpiochip6", "/dev/gpiochip60", "/dev/gpiochip61", "/dev/gpiochip62", "/dev/gpiochip63", "/dev/gpiochip64", "/dev/gpiochip7", "/dev/gpiochip8", "/dev/gpiochip9", "/dev/gsa0", "/dev/gsc0", "/dev/gti.0", "/dev/gxp", "/dev/hdcp2", "/dev/hw_random", "/dev/i2c-10", "/dev/i2c-19", "/dev/i2c-2", "/dev/i2c-3", "/dev/i2c-4", "/dev/i2c-5", "/dev/i2c-6", "/dev/i2c-7", "/dev/i2c-8", "/dev/i2c-9", "/dev/input/event0", "/dev/input/event1", "/dev/input/event2", "/dev/input/event3", "/dev/ispolin_ranging", "/dev/kmsg", "/dev/kvm", "/dev/logbuffer_bd", "/dev/logbuffer_btlpm", "/dev/logbuffer_cpif", "/dev/logbuffer_cpm", "/dev/logbuffer_dsim0", "/dev/logbuffer_max77779_fwupdate", "/dev/logbuffer_max77779fg", "/dev/logbuffer_max77779fg_monitor", "/dev/logbuffer_pca9468", "/dev/logbuffer_pcie0", "/dev/logbuffer_pcie1", "/dev/logbuffer_rtx", "/dev/logbuffer_ssoc", "/dev/logbuffer_tcpm", "/dev/logbuffer_ttf", "/dev/logbuffer_tty18", "/dev/logbuffer_usbpd", "/dev/logbuffer_wireless", "/dev/loop-control", "/dev/lwis-act-cornerfolk", "/dev/lwis-act-cornerfolk-dokkaebi", "/dev/lwis-act-cornerfolk-taotie-uw", "/dev/lwis-be-core", "/dev/lwis-dpm", "/dev/lwis-eeprom-djinn", "/dev/lwis-eeprom-smaug-dokkaebi", "/dev/lwis-eeprom-smaug-taotie-uw", "/dev/lwis-flash-lm3644", "/dev/lwis-gdc0", "/dev/lwis-gdc1", "/dev/lwis-gse", "/dev/lwis-gtnr-align", "/dev/lwis-gtnr-merge", "/dev/lwis-isp-fe", "/dev/lwis-lme", "/dev/lwis-mcsc", "/dev/lwis-ois-djinn", "/dev/lwis-sensor-boitata", "/dev/lwis-sensor-dokkaebi", "/dev/lwis-sensor-taotie-uw", "/dev/lwis-slc", "/dev/lwis-test", "/dev/lwis-top", "/dev/lwis-votf", "/dev/mali0", "/dev/multipdp", "/devull", "/dev/oem_ipc0", "/dev/oem_ipc1", "/dev/oem_ipc2", "/dev/oem_ipc3", "/dev/oem_ipc4", "/dev/oem_ipc5", "/dev/oem_ipc6", "/dev/oem_ipc7", "/dev/oem_test", "/dev/pmsg0", "/dev/ppp", "/dev/ptmx", "/dev/pts/0", "/dev/pts/1", "/dev/pts/ptmx", "/dev/qbt_fd", "/dev/qbt_ipc", "/dev/random", "/dev/rfkill", "/dev/rio", "/dev/rtc0", "/dev/sg0", "/dev/sg1", "/dev/sg2", "/dev/sg3", "/dev/sg4", "/dev/sg5", "/dev/sg6", "/dev/snapshot", "/dev/snd/comprC0D6", "/dev/snd/controlC0", "/dev/snd/pcmC0D0p", "/dev/snd/pcmC0D10c", "/dev/snd/pcmC0D11c", "/dev/snd/pcmC0D12c", "/dev/snd/pcmC0D13c", "/dev/snd/pcmC0D14p", "/dev/snd/pcmC0D15c", "/dev/snd/pcmC0D16p", "/dev/snd/pcmC0D17c", "/dev/snd/pcmC0D18p", "/dev/snd/pcmC0D19p", "/dev/snd/pcmC0D1p", "/dev/snd/pcmC0D20c", "/dev/snd/pcmC0D21c", "/dev/snd/pcmC0D22c", "/dev/snd/pcmC0D23p", "/dev/snd/pcmC0D24p", "/dev/snd/pcmC0D25p", "/dev/snd/pcmC0D26c", "/dev/snd/pcmC0D27c", "/dev/snd/pcmC0D28p", "/dev/snd/pcmC0D29p", "/dev/snd/pcmC0D2p", "/dev/snd/pcmC0D30p", "/dev/snd/pcmC0D31p", "/dev/snd/pcmC0D32c", "/dev/snd/pcmC0D3p", "/dev/snd/pcmC0D4p", "/dev/snd/pcmC0D53p", "/dev/snd/pcmC0D54c", "/dev/snd/pcmC0D5p", "/dev/snd/pcmC0D7p", "/dev/snd/pcmC0D8c", "/dev/snd/pcmC0D9c", "/dev/snd/timer", "/dev/sscd_aoc", "/dev/sscd_bigwave", "/dev/sscd_debugcore", "/dev/sscd_gnss", "/dev/sscd_gxp_callisto", "/dev/sscd_mali", "/dev/sscd_mfc-core", "/dev/sscd_rio", "/dev/sscd_wlan", "/dev/st21nfc", "/dev/st54spi", "/dev/tcm0", "/dev/touch_offload", "/dev/trusty-ipc-dev0", "/dev/trusty-log0", "/dev/tty", "/dev/ttyGS0", "/dev/ttyGS1", "/dev/ttyGS2", "/dev/ttySAC0", "/dev/ttySAC18", "/dev/ttynull", "/dev/tui-driver", "/dev/tun", "/dev/ublk-control", "/dev/ufs-bsg0", "/dev/uhid", "/dev/uinput", "/dev/umts_boot0", "/dev/umts_dm0", "/dev/umts_ipc0", "/dev/umts_ipc1", "/dev/umts_loopback", "/dev/umts_rcs0", "/dev/umts_rcs1", "/dev/umts_rfs0", "/dev/umts_router", "/dev/umts_toe0", "/dev/umts_wfc0", "/dev/umts_wfc1", "/dev/urandom", "/dev/usb_accessory", "/dev/userfaultfd", "/dev/v4l-touch0", "/dev/vhost-vsock", "/dev/video10", "/dev/video11", "/dev/video12", "/dev/video6", "/dev/video7", "/dev/video8", "/dev/video9", "/dev/vsock", "/dev/watchdog", "/dev/watchdog0", "/dev/watchdog1", "/dev/wbrc", "/dev/zero", "/sys/fs/selinuxull", };
  for (int deviceIndex=0; deviceIndex < 370; ++deviceIndex) {
    if (0 < open(devices[deviceIndex], O_RDWR) ) {
      printf("%s\n", devices[deviceIndex]);       
    }
  }
  return 0;
}
        </code></pre>
        <details>
        <summary>Directly assessible character devices from unprivileged context</summary>
          <ul>
          <li>/dev/ashmem</li>
          <li>/dev/ashmema89909c8-c70e-430d-8521-dfc7ad14edb7</li>
          <li>/dev/binderfs/binder</li>
          <li>/dev/binderfs/hwbinder</li>
          <li>/dev/mali0</li>
          <li>/dev/ptmx</li>
          <li>/dev/pts/0</li>
          <li>/dev/pts/1</li>
          <li>/dev/random</li>
          <li>/dev/tty</li>
          <li>/dev/urandom</li>
          <li>/dev/zero
          </ul>
        </details>

       </div>
    </article>
</body>
</html>
